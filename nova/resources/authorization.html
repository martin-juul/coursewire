<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Authorization | CourseWire Docs</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Informing about educations">
    <meta name="theme-color" content="#c87f2f">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/coursewire/assets/css/0.styles.bfc8dd69.css" as="style"><link rel="preload" href="/coursewire/assets/js/app.02511102.js" as="script"><link rel="preload" href="/coursewire/assets/js/2.fbd24a80.js" as="script"><link rel="preload" href="/coursewire/assets/js/42.73b1c1d1.js" as="script"><link rel="prefetch" href="/coursewire/assets/js/10.4212c2f9.js"><link rel="prefetch" href="/coursewire/assets/js/11.3c48ff1c.js"><link rel="prefetch" href="/coursewire/assets/js/12.8c4af0eb.js"><link rel="prefetch" href="/coursewire/assets/js/13.bf842588.js"><link rel="prefetch" href="/coursewire/assets/js/14.37b2191d.js"><link rel="prefetch" href="/coursewire/assets/js/15.c876d26f.js"><link rel="prefetch" href="/coursewire/assets/js/16.073345a7.js"><link rel="prefetch" href="/coursewire/assets/js/17.e24f1dd7.js"><link rel="prefetch" href="/coursewire/assets/js/18.8bfdb26b.js"><link rel="prefetch" href="/coursewire/assets/js/19.ffc8cf96.js"><link rel="prefetch" href="/coursewire/assets/js/20.36a0871b.js"><link rel="prefetch" href="/coursewire/assets/js/21.35f26c2d.js"><link rel="prefetch" href="/coursewire/assets/js/22.e5eca7c6.js"><link rel="prefetch" href="/coursewire/assets/js/23.585f7050.js"><link rel="prefetch" href="/coursewire/assets/js/24.1eb91c63.js"><link rel="prefetch" href="/coursewire/assets/js/25.b87544a9.js"><link rel="prefetch" href="/coursewire/assets/js/26.ca38d820.js"><link rel="prefetch" href="/coursewire/assets/js/27.cdd47a7e.js"><link rel="prefetch" href="/coursewire/assets/js/28.910457fd.js"><link rel="prefetch" href="/coursewire/assets/js/29.c1ae8d42.js"><link rel="prefetch" href="/coursewire/assets/js/3.8bf11098.js"><link rel="prefetch" href="/coursewire/assets/js/30.5cc41175.js"><link rel="prefetch" href="/coursewire/assets/js/31.9e2127cc.js"><link rel="prefetch" href="/coursewire/assets/js/32.5397ea66.js"><link rel="prefetch" href="/coursewire/assets/js/33.45080a30.js"><link rel="prefetch" href="/coursewire/assets/js/34.6e3f0c23.js"><link rel="prefetch" href="/coursewire/assets/js/35.ddd28f5a.js"><link rel="prefetch" href="/coursewire/assets/js/36.bfb957fe.js"><link rel="prefetch" href="/coursewire/assets/js/37.52edfd39.js"><link rel="prefetch" href="/coursewire/assets/js/38.0c7c9bb2.js"><link rel="prefetch" href="/coursewire/assets/js/39.134dd667.js"><link rel="prefetch" href="/coursewire/assets/js/4.c93ddc9d.js"><link rel="prefetch" href="/coursewire/assets/js/40.0321689a.js"><link rel="prefetch" href="/coursewire/assets/js/41.685503da.js"><link rel="prefetch" href="/coursewire/assets/js/43.ff4aa68f.js"><link rel="prefetch" href="/coursewire/assets/js/44.2cb09a15.js"><link rel="prefetch" href="/coursewire/assets/js/45.9071b634.js"><link rel="prefetch" href="/coursewire/assets/js/46.691acbad.js"><link rel="prefetch" href="/coursewire/assets/js/47.09900fe0.js"><link rel="prefetch" href="/coursewire/assets/js/48.31c05462.js"><link rel="prefetch" href="/coursewire/assets/js/49.3eb88337.js"><link rel="prefetch" href="/coursewire/assets/js/5.acf75b03.js"><link rel="prefetch" href="/coursewire/assets/js/50.be69d7ce.js"><link rel="prefetch" href="/coursewire/assets/js/51.d6025ff9.js"><link rel="prefetch" href="/coursewire/assets/js/52.afab6d12.js"><link rel="prefetch" href="/coursewire/assets/js/6.a7a1e44e.js"><link rel="prefetch" href="/coursewire/assets/js/7.cf5f8500.js"><link rel="prefetch" href="/coursewire/assets/js/8.80f7340e.js"><link rel="prefetch" href="/coursewire/assets/js/9.749dd9d2.js">
    <link rel="stylesheet" href="/coursewire/assets/css/0.styles.bfc8dd69.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/coursewire/" class="home-link router-link-active"><!----> <span class="site-name">CourseWire Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/coursewire/specification/" class="nav-link">
  Specification
</a></div><div class="nav-item"><a href="/coursewire/setup/" class="nav-link">
  Setup
</a></div><div class="nav-item"><a href="/coursewire/style-guide/" class="nav-link">
  Style guide
</a></div><div class="nav-item"><a href="/coursewire/nova/" class="nav-link router-link-active">
  Nova
</a></div><div class="nav-item"><a href="/coursewire/forge/" class="nav-link">
  Forge
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/coursewire/specification/" class="nav-link">
  Specification
</a></div><div class="nav-item"><a href="/coursewire/setup/" class="nav-link">
  Setup
</a></div><div class="nav-item"><a href="/coursewire/style-guide/" class="nav-link">
  Style guide
</a></div><div class="nav-item"><a href="/coursewire/nova/" class="nav-link router-link-active">
  Nova
</a></div><div class="nav-item"><a href="/coursewire/forge/" class="nav-link">
  Forge
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Nova</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/coursewire/nova/" aria-current="page" class="sidebar-link">Laravel Nova</a></li><li><a href="/coursewire/nova/actions/defining-actions.html" class="sidebar-link">Defining Actions</a></li><li><a href="/coursewire/nova/actions/registering-actions.html" class="sidebar-link">Registering Actions</a></li><li><a href="/coursewire/nova/customization/assets.html" class="sidebar-link">Assets</a></li><li><a href="/coursewire/nova/customization/cards.html" class="sidebar-link">Cards</a></li><li><a href="/coursewire/nova/customization/dashboards.html" class="sidebar-link">Dashboards</a></li><li><a href="/coursewire/nova/customization/fields.html" class="sidebar-link">Fields</a></li><li><a href="/coursewire/nova/customization/frontend.html" class="sidebar-link">CSS / JavaScript</a></li><li><a href="/coursewire/nova/customization/localization.html" class="sidebar-link">Localization</a></li><li><a href="/coursewire/nova/customization/resource-tools.html" class="sidebar-link">Resource Tools</a></li><li><a href="/coursewire/nova/customization/stubs.html" class="sidebar-link">Stubs</a></li><li><a href="/coursewire/nova/customization/themes.html" class="sidebar-link">Themes</a></li><li><a href="/coursewire/nova/customization/tools.html" class="sidebar-link">Tools</a></li><li><a href="/coursewire/nova/dashboard/metrics.html" class="sidebar-link">Metrics</a></li><li><a href="/coursewire/nova/dashboard/tools.html" class="sidebar-link">Tools</a></li><li><a href="/coursewire/nova/filters/defining-filters.html" class="sidebar-link">Defining Filters</a></li><li><a href="/coursewire/nova/filters/registering-filters.html" class="sidebar-link">Registering Filters</a></li><li><a href="/coursewire/nova/lenses/defining-lenses.html" class="sidebar-link">Defining Lenses</a></li><li><a href="/coursewire/nova/lenses/registering-lenses.html" class="sidebar-link">Registering Lenses</a></li><li><a href="/coursewire/nova/metrics/defining-metrics.html" class="sidebar-link">Defining Metrics</a></li><li><a href="/coursewire/nova/metrics/registering-metrics.html" class="sidebar-link">Registering Metrics</a></li><li><a href="/coursewire/nova/nova-js/" class="sidebar-link">Overview</a></li><li><a href="/coursewire/nova/nova-js/event-bus.html" class="sidebar-link">Event Bus</a></li><li><a href="/coursewire/nova/nova-js/methods.html" class="sidebar-link">Methods</a></li><li><a href="/coursewire/nova/nova-js/properties.html" class="sidebar-link">Properties</a></li><li><a href="/coursewire/nova/resources/" aria-current="page" class="sidebar-link">The Basics</a></li><li><a href="/coursewire/nova/resources/authorization.html" aria-current="page" class="active sidebar-link">Authorization</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/coursewire/nova/resources/authorization.html#policies" class="sidebar-link">Policies</a></li><li class="sidebar-sub-header"><a href="/coursewire/nova/resources/authorization.html#fields" class="sidebar-link">Fields</a></li><li class="sidebar-sub-header"><a href="/coursewire/nova/resources/authorization.html#index-filtering" class="sidebar-link">Index Filtering</a></li><li class="sidebar-sub-header"><a href="/coursewire/nova/resources/authorization.html#relatable-filtering" class="sidebar-link">Relatable Filtering</a></li><li class="sidebar-sub-header"><a href="/coursewire/nova/resources/authorization.html#scout-filtering" class="sidebar-link">Scout Filtering</a></li></ul></li><li><a href="/coursewire/nova/resources/date-fields.html" class="sidebar-link">Date Fields</a></li><li><a href="/coursewire/nova/resources/fields.html" class="sidebar-link">Fields</a></li><li><a href="/coursewire/nova/resources/file-fields.html" class="sidebar-link">File Fields</a></li><li><a href="/coursewire/nova/resources/relationships.html" class="sidebar-link">Relationships</a></li><li><a href="/coursewire/nova/resources/validation.html" class="sidebar-link">Validation</a></li><li><a href="/coursewire/nova/search/global-search.html" class="sidebar-link">Global Search</a></li><li><a href="/coursewire/nova/search/scout-integration.html" class="sidebar-link">Scout Integration</a></li><li><a href="/coursewire/nova/installation.html" class="sidebar-link">Installation</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="authorization"><a href="#authorization" class="header-anchor">#</a> Authorization</h1> <p></p><div class="table-of-contents"><ul><li><a href="#policies">Policies</a><ul><li><a href="#hiding-entire-resources">Hiding Entire Resources</a></li><li><a href="#relationships">Relationships</a></li><li><a href="#disabling-authorization">Disabling Authorization</a></li></ul></li><li><a href="#fields">Fields</a></li><li><a href="#index-filtering">Index Filtering</a></li><li><a href="#relatable-filtering">Relatable Filtering</a></li><li><a href="#scout-filtering">Scout Filtering</a></li></ul></div><p></p> <p>When Nova is accessed only by you or your development team, you may not need additional authorization before Nova handles incoming requests. However, if you provide access to Nova to your clients or large team of developers, you may wish to authorize certain requests. For example, perhaps only administrators may delete records. Thankfully, Nova takes a simple approach to authorization that leverages many of the Laravel features you are already familiar with.</p> <h2 id="policies"><a href="#policies" class="header-anchor">#</a> Policies</h2> <p>To limit which users may view, create, update, or delete resources, Nova leverages Laravel's <a href="https://laravel.com/docs/authorization#creating-policies" target="_blank" rel="noopener noreferrer">authorization policies<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. Policies are simple PHP classes that organize authorization logic for a particular model or resource. For example, if your application is a blog, you may have a <code>Post</code> model and a corresponding <code>PostPolicy</code> within your application.</p> <p>When manipulating a resource within Nova, Nova will automatically attempt to find a corresponding policy for the model. Typically, these policies will be registered in your application's <code>AuthServiceProvider</code>. If Nova detects a policy has been registered for the model, it will automatically check that policy's relevant authorization methods before performing their respective actions, such as:</p> <ul><li><code>viewAny</code></li> <li><code>view</code></li> <li><code>create</code></li> <li><code>update</code></li> <li><code>delete</code></li> <li><code>restore</code></li> <li><code>forceDelete</code></li></ul> <p>No additional configuration is required! So, for example, to determine which users are allowed to update a <code>Post</code> model, you simply need to define an <code>update</code> method on the model's corresponding policy class:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Policies</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>Access<span class="token punctuation">\</span>HandlesAuthorization</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">PostPolicy</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">HandlesAuthorization</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Determine whether the user can update the post.
     *
     * @param  \App\User  $user
     * @param  \App\Post  $post
     * @return mixed
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">update</span><span class="token punctuation">(</span>User <span class="token variable">$user</span><span class="token punctuation">,</span> Post <span class="token variable">$post</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">type</span> <span class="token operator">==</span> <span class="token single-quoted-string string">'editor'</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><div class="custom-block warning"><p class="custom-block-title">Undefined Policy Methods</p> <p>If a policy exists but is missing a method for a particular action, the user will not be allowed to perform that action. So, if you have defined a policy, don't forget to define all of its relevant authorization methods.</p></div> <h3 id="hiding-entire-resources"><a href="#hiding-entire-resources" class="header-anchor">#</a> Hiding Entire Resources</h3> <p>If you would like to hide an entire Nova resource from a subset of your dashboard's users, you may define a <code>viewAny</code> method on the model's policy class. If no <code>viewAny</code> method is defined for a given policy, Nova will assume that the user can view the resource:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Policies</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Post</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>Access<span class="token punctuation">\</span>HandlesAuthorization</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">PostPolicy</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">HandlesAuthorization</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Determine whether the user can view any posts.
     *
     * @param  \App\User  $user
     * @return mixed
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">viewAny</span><span class="token punctuation">(</span>User <span class="token variable">$user</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">in_array</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'view-posts'</span><span class="token punctuation">,</span> <span class="token variable">$user</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">permissions</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><h3 id="relationships"><a href="#relationships" class="header-anchor">#</a> Relationships</h3> <p>We have already learned how to authorize the typical view, create, update, and delete actions, but what about relationship interactions? For example, if you are building a podcasting application, perhaps you would like to specify that only certain Nova users may add comments to podcasts. Again, Nova makes this simple by leveraging Laravel's policies.</p> <p>When working with relationships, Nova uses a simple policy method naming convention. To illustrate this convention, lets assume your application has <code>Podcast</code> resources and <code>Comment</code> resources. If you would like to authorize which users can add comments to a podcast, you should define an <code>addComment</code> method on your podcast model's policy class:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Policies</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Podcast</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>Access<span class="token punctuation">\</span>HandlesAuthorization</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">PodcastPolicy</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">HandlesAuthorization</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Determine whether the user can add a comment to the podcast.
     *
     * @param  \App\User  $user
     * @param  \App\Podcast  $podcast
     * @return mixed
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">addComment</span><span class="token punctuation">(</span>User <span class="token variable">$user</span><span class="token punctuation">,</span> Podcast <span class="token variable">$podcast</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>As you can see, Nova uses a simple <code>add{Model}</code> policy method naming convention for authorizing relationship actions.</p> <h4 id="authorizing-attaching-detaching"><a href="#authorizing-attaching-detaching" class="header-anchor">#</a> Authorizing Attaching / Detaching</h4> <p>For many-to-many relationships, Nova uses a similar naming convention. However, instead of <code>add{Model}</code>, you should use an <code>attach{Model}</code> / <code>detach{Model}</code> naming convention. For example, imagine a <code>Podcast</code> model has a many-to-many relationship with the <code>Tag</code> model. If you would like to authorize which users can attach &quot;tags&quot; to a podcast, you may add an <code>attachTag</code> method to your podcast policy. In addition, you will likely want to define the inverse <code>attachPodcast</code> on the tag policy:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Policies</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Tag</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Podcast</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>Access<span class="token punctuation">\</span>HandlesAuthorization</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">PodcastPolicy</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">HandlesAuthorization</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Determine whether the user can attach a tag to a podcast.
     *
     * @param  \App\User  $user
     * @param  \App\Podcast  $podcast
     * @param  \App\Tag  $tag
     * @return mixed
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">attachTag</span><span class="token punctuation">(</span>User <span class="token variable">$user</span><span class="token punctuation">,</span> Podcast <span class="token variable">$podcast</span><span class="token punctuation">,</span> Tag <span class="token variable">$tag</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">/**
     * Determine whether the user can detach a tag from a podcast.
     *
     * @param  \App\User  $user
     * @param  \App\Podcast  $podcast
     * @param  \App\Tag  $tag
     * @return mixed
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">detachTag</span><span class="token punctuation">(</span>User <span class="token variable">$user</span><span class="token punctuation">,</span> Podcast <span class="token variable">$podcast</span><span class="token punctuation">,</span> Tag <span class="token variable">$tag</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>In the previous examples, we are determining if a user is authorized to attach one model to another. If certain types of users are <strong>never</strong> allowed to attach a given type of model, you may define a <code>attachAny{Model}</code> method on your policy class. This will prevent the &quot;Attach&quot; button from displaying in the Nova UI entirely:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Policies</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>User</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>Podcast</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>Access<span class="token punctuation">\</span>HandlesAuthorization</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">PodcastPolicy</span>
<span class="token punctuation">{</span>
    <span class="token keyword">use</span> <span class="token package">HandlesAuthorization</span><span class="token punctuation">;</span>

    <span class="token comment">/**
     * Determine whether the user can attach any tags to the podcast.
     *
     * @param  \App\User  $user
     * @param  \App\Podcast  $podcast
     * @return mixed
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">attachAnyTag</span><span class="token punctuation">(</span>User <span class="token variable">$user</span><span class="token punctuation">,</span> Podcast <span class="token variable">$podcast</span><span class="token punctuation">)</span>
    <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><div class="custom-block warning"><p class="custom-block-title">Many To Many Authorization</p> <p>When working with many-to-many relationships, make sure you define the proper authorization policy methods on each of the involved resource's policy classes.</p></div> <h3 id="disabling-authorization"><a href="#disabling-authorization" class="header-anchor">#</a> Disabling Authorization</h3> <p>If one of your Nova resources' models has a corresponding policy, but you want to disable Nova authorization for that resource, you may override the <code>authorizable</code> method on the Nova resource:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Determine if the given resource is authorizable.
 *
 * @return bool
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">authorizable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token boolean constant">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="fields"><a href="#fields" class="header-anchor">#</a> Fields</h2> <p>Sometimes you may want to hide certain fields from a group of users. You may easily accomplish this by chaining the <code>canSee</code> method onto your field definition. The <code>canSee</code> method accepts a Closure which should return <code>true</code> or <code>false</code>. The Closure will receive the incoming HTTP request:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Fields<span class="token punctuation">\</span>ID</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Fields<span class="token punctuation">\</span>Text</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Get the fields displayed by the resource.
 *
 * @param  \Illuminate\Http\Request  $request
 * @return array
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">fields</span><span class="token punctuation">(</span>Request <span class="token variable">$request</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token constant">ID</span><span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">sortable</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>

        Text<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Name'</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">sortable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">canSee</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token variable">$request</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token keyword">return</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">can</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'viewProfile'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>In the example above, we are using Laravel's <code>Authorizable</code> trait's <code>can</code> method on our <code>User</code> model to determine if the authorized user is authorized for the <code>viewProfile</code> action. However, since proxying to authorization policy methods is a common use-case for <code>canSee</code>, you may use the <code>canSeeWhen</code> method to achieve the same behavior. The <code>canSeeWhen</code> method has the same method signature as the <code>Illuminate\Foundation\Auth\Access\Authorizable</code> trait's <code>can</code> method:</p> <div class="language-php extra-class"><pre class="language-php"><code>Text<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Name'</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">sortable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">canSeeWhen</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'viewProfile'</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">Authorization &amp; The &quot;Can&quot; Method</p> <p>To learn more about Laravel's authorization helpers and the <code>can</code> method, check out the full Laravel <a href="https://laravel.com/docs/authorization#via-the-user-model" target="_blank" rel="noopener noreferrer">authorization documentation<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <h2 id="index-filtering"><a href="#index-filtering" class="header-anchor">#</a> Index Filtering</h2> <p>You may notice that returning <code>false</code> from a policy's <code>view</code> method does not stop a given resource from appearing in the resource index. To filter models from the resource index query, you may override the <code>indexQuery</code> method on your resource. This method is already stubbed in your <code>App\Nova\Resource</code> base class, you may simply copy and paste it into a specific resource and then modify the query:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Build an &quot;index&quot; query for the given resource.
 *
 * @param  \Laravel\Nova\Http\Requests\NovaRequest  $request
 * @param  \Illuminate\Database\Eloquent\Builder  $query
 * @return \Illuminate\Database\Eloquent\Builder
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">indexQuery</span><span class="token punctuation">(</span>NovaRequest <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$query</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'user_id'</span><span class="token punctuation">,</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="relatable-filtering"><a href="#relatable-filtering" class="header-anchor">#</a> Relatable Filtering</h2> <p>If you would like to filter the queries that are used to populate relationship model selection menus, you may override the <code>relatableQuery</code> method on your resource.</p> <p>For example, if your application has a <code>Comment</code> resource that belongs to a <code>Podcast</code> resource, Nova will allow you to select the parent <code>Podcast</code> when creating a <code>Comment</code>. To limit the podcasts that are available in that selection menu, you should override the <code>relatableQuery</code> method on your <code>Podcast</code> resource:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Build a &quot;relatable&quot; query for the given resource.
 *
 * This query determines which instances of the model may be attached to other resources.
 *
 * @param  \Laravel\Nova\Http\Requests\NovaRequest  $request
 * @param  \Illuminate\Database\Eloquent\Builder  $query
 * @return \Illuminate\Database\Eloquent\Builder
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">relatableQuery</span><span class="token punctuation">(</span>NovaRequest <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$query</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'user_id'</span><span class="token punctuation">,</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>You can filter individual relationships by using a dynamic function. For example, if your application has a <code>Post</code> resource, in which posts can be tagged, but the <code>Tag</code> resource has different types, you can use a dynamic <code>relatableQuery</code>:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Build a &quot;relatable&quot; query for the given resource.
 *
 * This query determines which instances of the model may be attached to other resources.
 *
 * @param  \Laravel\Nova\Http\Requests\NovaRequest  $request
 * @param  \Illuminate\Database\Eloquent\Builder  $query
 * @return \Illuminate\Database\Eloquent\Builder
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">relatableTags</span><span class="token punctuation">(</span>NovaRequest <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$query</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'type'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'posts'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Further, if you need to filter <code>Tag</code> resource dynamically, you can access the route parameters like so:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">relatableTags</span><span class="token punctuation">(</span>NovaRequest <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$resource</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'resource'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Returns the resource type.</span>
    <span class="token variable">$resourceId</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">route</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'resourceId'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Returns the resource id.</span>

    <span class="token keyword">return</span> <span class="token variable">$query</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'type'</span><span class="token punctuation">,</span> <span class="token variable">$resource</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="scout-filtering"><a href="#scout-filtering" class="header-anchor">#</a> Scout Filtering</h2> <p>If your application is leveraging the power of Laravel Scout for <a href="/coursewire/nova/search/scout-integration.html">search</a>, you may also customize the <code>Laravel\Scout\Builder</code> query instance before it is sent to your search provider. To accomplish this, override the <code>scoutQuery</code> method on your resource:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Build a Scout search query for the given resource.
 *
 * @param  \Laravel\Nova\Http\Requests\NovaRequest  $request
 * @param  \Laravel\Scout\Builder  $query
 * @return \Laravel\Scout\Builder
 */</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function">scoutQuery</span><span class="token punctuation">(</span>NovaRequest <span class="token variable">$request</span><span class="token punctuation">,</span> <span class="token variable">$query</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token variable">$query</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">where</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'user_id'</span><span class="token punctuation">,</span> <span class="token variable">$request</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">user</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/26/2020, 6:59:37 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/coursewire/nova/resources/" class="prev router-link-active">
        The Basics
      </a></span> <span class="next"><a href="/coursewire/nova/resources/date-fields.html">
        Date Fields
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/coursewire/assets/js/app.02511102.js" defer></script><script src="/coursewire/assets/js/2.fbd24a80.js" defer></script><script src="/coursewire/assets/js/42.73b1c1d1.js" defer></script>
  </body>
</html>
