<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Defining Actions | CourseWire Docs</title>
    <meta name="generator" content="VuePress 1.7.1">
    
    <meta name="description" content="Informing about educations">
    <meta name="theme-color" content="#c87f2f">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/coursewire/assets/css/0.styles.bfc8dd69.css" as="style"><link rel="preload" href="/coursewire/assets/js/app.02511102.js" as="script"><link rel="preload" href="/coursewire/assets/js/2.fbd24a80.js" as="script"><link rel="preload" href="/coursewire/assets/js/16.073345a7.js" as="script"><link rel="prefetch" href="/coursewire/assets/js/10.4212c2f9.js"><link rel="prefetch" href="/coursewire/assets/js/11.3c48ff1c.js"><link rel="prefetch" href="/coursewire/assets/js/12.8c4af0eb.js"><link rel="prefetch" href="/coursewire/assets/js/13.bf842588.js"><link rel="prefetch" href="/coursewire/assets/js/14.37b2191d.js"><link rel="prefetch" href="/coursewire/assets/js/15.c876d26f.js"><link rel="prefetch" href="/coursewire/assets/js/17.e24f1dd7.js"><link rel="prefetch" href="/coursewire/assets/js/18.8bfdb26b.js"><link rel="prefetch" href="/coursewire/assets/js/19.ffc8cf96.js"><link rel="prefetch" href="/coursewire/assets/js/20.36a0871b.js"><link rel="prefetch" href="/coursewire/assets/js/21.35f26c2d.js"><link rel="prefetch" href="/coursewire/assets/js/22.e5eca7c6.js"><link rel="prefetch" href="/coursewire/assets/js/23.585f7050.js"><link rel="prefetch" href="/coursewire/assets/js/24.1eb91c63.js"><link rel="prefetch" href="/coursewire/assets/js/25.b87544a9.js"><link rel="prefetch" href="/coursewire/assets/js/26.ca38d820.js"><link rel="prefetch" href="/coursewire/assets/js/27.cdd47a7e.js"><link rel="prefetch" href="/coursewire/assets/js/28.910457fd.js"><link rel="prefetch" href="/coursewire/assets/js/29.c1ae8d42.js"><link rel="prefetch" href="/coursewire/assets/js/3.8bf11098.js"><link rel="prefetch" href="/coursewire/assets/js/30.5cc41175.js"><link rel="prefetch" href="/coursewire/assets/js/31.9e2127cc.js"><link rel="prefetch" href="/coursewire/assets/js/32.5397ea66.js"><link rel="prefetch" href="/coursewire/assets/js/33.45080a30.js"><link rel="prefetch" href="/coursewire/assets/js/34.6e3f0c23.js"><link rel="prefetch" href="/coursewire/assets/js/35.ddd28f5a.js"><link rel="prefetch" href="/coursewire/assets/js/36.bfb957fe.js"><link rel="prefetch" href="/coursewire/assets/js/37.52edfd39.js"><link rel="prefetch" href="/coursewire/assets/js/38.0c7c9bb2.js"><link rel="prefetch" href="/coursewire/assets/js/39.134dd667.js"><link rel="prefetch" href="/coursewire/assets/js/4.c93ddc9d.js"><link rel="prefetch" href="/coursewire/assets/js/40.0321689a.js"><link rel="prefetch" href="/coursewire/assets/js/41.685503da.js"><link rel="prefetch" href="/coursewire/assets/js/42.73b1c1d1.js"><link rel="prefetch" href="/coursewire/assets/js/43.ff4aa68f.js"><link rel="prefetch" href="/coursewire/assets/js/44.2cb09a15.js"><link rel="prefetch" href="/coursewire/assets/js/45.9071b634.js"><link rel="prefetch" href="/coursewire/assets/js/46.691acbad.js"><link rel="prefetch" href="/coursewire/assets/js/47.09900fe0.js"><link rel="prefetch" href="/coursewire/assets/js/48.31c05462.js"><link rel="prefetch" href="/coursewire/assets/js/49.3eb88337.js"><link rel="prefetch" href="/coursewire/assets/js/5.acf75b03.js"><link rel="prefetch" href="/coursewire/assets/js/50.be69d7ce.js"><link rel="prefetch" href="/coursewire/assets/js/51.d6025ff9.js"><link rel="prefetch" href="/coursewire/assets/js/52.afab6d12.js"><link rel="prefetch" href="/coursewire/assets/js/6.a7a1e44e.js"><link rel="prefetch" href="/coursewire/assets/js/7.cf5f8500.js"><link rel="prefetch" href="/coursewire/assets/js/8.80f7340e.js"><link rel="prefetch" href="/coursewire/assets/js/9.749dd9d2.js">
    <link rel="stylesheet" href="/coursewire/assets/css/0.styles.bfc8dd69.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/coursewire/" class="home-link router-link-active"><!----> <span class="site-name">CourseWire Docs</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/coursewire/specification/" class="nav-link">
  Specification
</a></div><div class="nav-item"><a href="/coursewire/setup/" class="nav-link">
  Setup
</a></div><div class="nav-item"><a href="/coursewire/style-guide/" class="nav-link">
  Style guide
</a></div><div class="nav-item"><a href="/coursewire/nova/" class="nav-link router-link-active">
  Nova
</a></div><div class="nav-item"><a href="/coursewire/forge/" class="nav-link">
  Forge
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/coursewire/specification/" class="nav-link">
  Specification
</a></div><div class="nav-item"><a href="/coursewire/setup/" class="nav-link">
  Setup
</a></div><div class="nav-item"><a href="/coursewire/style-guide/" class="nav-link">
  Style guide
</a></div><div class="nav-item"><a href="/coursewire/nova/" class="nav-link router-link-active">
  Nova
</a></div><div class="nav-item"><a href="/coursewire/forge/" class="nav-link">
  Forge
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Nova</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/coursewire/nova/" aria-current="page" class="sidebar-link">Laravel Nova</a></li><li><a href="/coursewire/nova/actions/defining-actions.html" aria-current="page" class="active sidebar-link">Defining Actions</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/coursewire/nova/actions/defining-actions.html#overview" class="sidebar-link">Overview</a></li><li class="sidebar-sub-header"><a href="/coursewire/nova/actions/defining-actions.html#destructive-actions" class="sidebar-link">Destructive Actions</a></li><li class="sidebar-sub-header"><a href="/coursewire/nova/actions/defining-actions.html#customizing-action-confirmation-buttons" class="sidebar-link">Customizing Action Confirmation Buttons</a></li><li class="sidebar-sub-header"><a href="/coursewire/nova/actions/defining-actions.html#action-fields" class="sidebar-link">Action Fields</a></li><li class="sidebar-sub-header"><a href="/coursewire/nova/actions/defining-actions.html#action-titles" class="sidebar-link">Action Titles</a></li><li class="sidebar-sub-header"><a href="/coursewire/nova/actions/defining-actions.html#action-modal-customization" class="sidebar-link">Action Modal Customization</a></li><li class="sidebar-sub-header"><a href="/coursewire/nova/actions/defining-actions.html#action-responses" class="sidebar-link">Action Responses</a></li><li class="sidebar-sub-header"><a href="/coursewire/nova/actions/defining-actions.html#queued-actions" class="sidebar-link">Queued Actions</a></li><li class="sidebar-sub-header"><a href="/coursewire/nova/actions/defining-actions.html#action-log" class="sidebar-link">Action Log</a></li></ul></li><li><a href="/coursewire/nova/actions/registering-actions.html" class="sidebar-link">Registering Actions</a></li><li><a href="/coursewire/nova/customization/assets.html" class="sidebar-link">Assets</a></li><li><a href="/coursewire/nova/customization/cards.html" class="sidebar-link">Cards</a></li><li><a href="/coursewire/nova/customization/dashboards.html" class="sidebar-link">Dashboards</a></li><li><a href="/coursewire/nova/customization/fields.html" class="sidebar-link">Fields</a></li><li><a href="/coursewire/nova/customization/frontend.html" class="sidebar-link">CSS / JavaScript</a></li><li><a href="/coursewire/nova/customization/localization.html" class="sidebar-link">Localization</a></li><li><a href="/coursewire/nova/customization/resource-tools.html" class="sidebar-link">Resource Tools</a></li><li><a href="/coursewire/nova/customization/stubs.html" class="sidebar-link">Stubs</a></li><li><a href="/coursewire/nova/customization/themes.html" class="sidebar-link">Themes</a></li><li><a href="/coursewire/nova/customization/tools.html" class="sidebar-link">Tools</a></li><li><a href="/coursewire/nova/dashboard/metrics.html" class="sidebar-link">Metrics</a></li><li><a href="/coursewire/nova/dashboard/tools.html" class="sidebar-link">Tools</a></li><li><a href="/coursewire/nova/filters/defining-filters.html" class="sidebar-link">Defining Filters</a></li><li><a href="/coursewire/nova/filters/registering-filters.html" class="sidebar-link">Registering Filters</a></li><li><a href="/coursewire/nova/lenses/defining-lenses.html" class="sidebar-link">Defining Lenses</a></li><li><a href="/coursewire/nova/lenses/registering-lenses.html" class="sidebar-link">Registering Lenses</a></li><li><a href="/coursewire/nova/metrics/defining-metrics.html" class="sidebar-link">Defining Metrics</a></li><li><a href="/coursewire/nova/metrics/registering-metrics.html" class="sidebar-link">Registering Metrics</a></li><li><a href="/coursewire/nova/nova-js/" class="sidebar-link">Overview</a></li><li><a href="/coursewire/nova/nova-js/event-bus.html" class="sidebar-link">Event Bus</a></li><li><a href="/coursewire/nova/nova-js/methods.html" class="sidebar-link">Methods</a></li><li><a href="/coursewire/nova/nova-js/properties.html" class="sidebar-link">Properties</a></li><li><a href="/coursewire/nova/resources/" class="sidebar-link">The Basics</a></li><li><a href="/coursewire/nova/resources/authorization.html" class="sidebar-link">Authorization</a></li><li><a href="/coursewire/nova/resources/date-fields.html" class="sidebar-link">Date Fields</a></li><li><a href="/coursewire/nova/resources/fields.html" class="sidebar-link">Fields</a></li><li><a href="/coursewire/nova/resources/file-fields.html" class="sidebar-link">File Fields</a></li><li><a href="/coursewire/nova/resources/relationships.html" class="sidebar-link">Relationships</a></li><li><a href="/coursewire/nova/resources/validation.html" class="sidebar-link">Validation</a></li><li><a href="/coursewire/nova/search/global-search.html" class="sidebar-link">Global Search</a></li><li><a href="/coursewire/nova/search/scout-integration.html" class="sidebar-link">Scout Integration</a></li><li><a href="/coursewire/nova/installation.html" class="sidebar-link">Installation</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="defining-actions"><a href="#defining-actions" class="header-anchor">#</a> Defining Actions</h1> <p></p><div class="table-of-contents"><ul><li><a href="#overview">Overview</a></li><li><a href="#destructive-actions">Destructive Actions</a></li><li><a href="#customizing-action-confirmation-buttons">Customizing Action Confirmation Buttons</a></li><li><a href="#action-fields">Action Fields</a></li><li><a href="#action-titles">Action Titles</a></li><li><a href="#action-modal-customization">Action Modal Customization</a></li><li><a href="#action-responses">Action Responses</a></li><li><a href="#queued-actions">Queued Actions</a></li><li><a href="#action-log">Action Log</a><ul><li><a href="#disabling-the-action-log">Disabling The Action Log</a></li><li><a href="#queued-action-statuses">Queued Action Statuses</a></li></ul></li></ul></div><p></p> <p>Nova actions allow you to perform custom tasks on one or more Eloquent models. For example, you might write an action that sends an email to a user containing account data they have requested. Or, you might write an action to transfer a group of records to another user.</p> <p>Once an action has been attached to a resource definition, you may initiate it from the resource's index or detail screens:</p> <p><img src="img/action.png" alt="Action"></p> <p>If an action is enabled for display on the resource's table row, you may initiate it from the resource's action dropdown menu. These are called &quot;Inline Actions&quot;:</p> <p><img src="img/inline-actions.png" alt="Inline Action"></p> <h2 id="overview"><a href="#overview" class="header-anchor">#</a> Overview</h2> <p>Nova actions may be generated using the <code>nova:action</code> Artisan command. By default, all actions are placed in the <code>app/Nova/Actions</code> directory:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>php artisan nova:action EmailAccountProfile
</code></pre></div><p>You may generate a <a href="#destructive-actions">destructive action</a> by passing the <code>--destructive</code> option:</p> <div class="language-bash extra-class"><pre class="language-bash"><code>php artisan nova:action DeleteUserData --destructive
</code></pre></div><p>To learn how to define Nova actions, let's look at an example. In this example, we'll define an action that sends an email message to a user or group of users:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Actions</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>AccountData</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Bus<span class="token punctuation">\</span>Queueable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Actions<span class="token punctuation">\</span>Action</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Collection</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Fields<span class="token punctuation">\</span>ActionFields</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Queue<span class="token punctuation">\</span>InteractsWithQueue</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Queue<span class="token punctuation">\</span>ShouldQueue</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">EmailAccountProfile</span> <span class="token keyword">extends</span> <span class="token class-name">Action</span>
<span class="token punctuation">{</span>
  <span class="token keyword">use</span> <span class="token package">InteractsWithQueue</span><span class="token punctuation">,</span> Queueable<span class="token punctuation">;</span>

  <span class="token comment">/**
   * Perform the action on the given models.
   *
   * @param  \Laravel\Nova\Fields\ActionFields  $fields
   * @param  \Illuminate\Support\Collection  $models
   * @return mixed
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span>ActionFields <span class="token variable">$fields</span><span class="token punctuation">,</span> Collection <span class="token variable">$models</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$models</span> <span class="token keyword">as</span> <span class="token variable">$model</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AccountData</span><span class="token punctuation">(</span><span class="token variable">$model</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token comment">/**
   * Get the fields available on the action.
   *
   * @return array
   */</span>
  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">fields</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>The most important method of an action is the <code>handle</code> method. The <code>handle</code> method receives the values for any fields attached to the action, as well as a collection of selected models. The <code>handle</code> method <strong>always</strong> receives a <code>Collection</code> of models, even if the action is only being performed against a single model.</p> <p>Within the <code>handle</code> method, you may perform whatever tasks are necessary to complete the action. You are free to update database records, send emails, call other services, etc. The sky is the limit!</p> <h2 id="destructive-actions"><a href="#destructive-actions" class="header-anchor">#</a> Destructive Actions</h2> <p>You may designate an action as destructive or dangerous by having your action class inherit from <code>Laravel\Nova\Actions\DestructiveAction</code>. This will change the color of the action's confirm button to red:</p> <p><img src="img/action-destructive.png" alt="Destructive Action"></p> <div class="custom-block warning"><p class="custom-block-title">Destructive Actions &amp; Policies</p> <p>When a destructive action is added to a resource that has an associated authorization policy, the policy's <code>delete</code> method must return <code>true</code> in order for the action to run.</p></div> <h2 id="customizing-action-confirmation-buttons"><a href="#customizing-action-confirmation-buttons" class="header-anchor">#</a> Customizing Action Confirmation Buttons</h2> <p>You may wish to present the user with a different color scheme than the default &quot;primary&quot; and &quot;destructive&quot; styling for the action depending on its type. You may customize the CSS classes used for the confirmation buttons by overriding the <code>actionClass</code> method on the <code>Action</code> class:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Return the CSS classes for the Action.
 *
 * @return string
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">actionClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token single-quoted-string string">'bg-success text-white'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="action-fields"><a href="#action-fields" class="header-anchor">#</a> Action Fields</h2> <p>Sometimes you may wish to gather additional information from the user before dispatching an action. For this reason, Nova allows you to attach most of Nova's supported <a href="/coursewire/nova/resources/fields.html">fields</a> directly to an action. When the action is initiated, Nova will prompt the user to provide input for the fields:</p> <p><img src="img/action-field.png" alt="Action Field"></p> <p>To add a field to an action, add the field to the array of fields returned by the action's <code>fields</code> method:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Fields<span class="token punctuation">\</span>Text</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Get the fields available on the action.
 *
 * @return array
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">fields</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        Text<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">make</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Subject'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Finally, within your action's <code>handle</code> method, you may access your fields using dynamic accessors on the provided <code>ActionFields</code> instance:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Perform the action on the given models.
 *
 * @param  \Laravel\Nova\Fields\ActionFields  $fields
 * @param  \Illuminate\Support\Collection  $models
 * @return mixed
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span>ActionFields <span class="token variable">$fields</span><span class="token punctuation">,</span> Collection <span class="token variable">$models</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$models</span> <span class="token keyword">as</span> <span class="token variable">$model</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AccountData</span><span class="token punctuation">(</span><span class="token variable">$model</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token variable">$fields</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">subject</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="action-titles"><a href="#action-titles" class="header-anchor">#</a> Action Titles</h2> <p>If you would like to change the action title that is displayed in Nova's action selection menu, you may define a <code>name</code> property on the action class:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * The displayable name of the action.
 *
 * @var string
 */</span>
<span class="token keyword">public</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'Action Title'</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="action-modal-customization"><a href="#action-modal-customization" class="header-anchor">#</a> Action Modal Customization</h2> <p>By default, actions will ask the user for confirmation before running. You can customize the confirmation message, confirm button, and cancel button to give the user more context before running the action. This is done by specifying the <code>confirmText</code>, <code>confirmButtonText</code>, and <code>cancelButtonText</code> methods when defining the action:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Get the actions available for the resource.
 *
 * @param  \Illuminate\Http\Request  $request
 * @return array
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">actions</span><span class="token punctuation">(</span>Request <span class="token variable">$request</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Actions<span class="token punctuation">\</span>ActivateUser</span><span class="token punctuation">)</span>
            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">confirmText</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Are you sure you want to activate this user?'</span><span class="token punctuation">)</span>
            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">confirmButtonText</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Activate'</span><span class="token punctuation">)</span>
            <span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">cancelButtonText</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&quot;Don't activate&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>This will customize the modal to look something like this:</p> <p><img src="img/action-customization.png" alt="Action Customization"></p> <h2 id="action-responses"><a href="#action-responses" class="header-anchor">#</a> Action Responses</h2> <p>Typically, when an action is executed, a generic &quot;success&quot; messages is displayed in the Nova UI. However, you are free to customize this response using a variety of methods on the <code>Action</code> class.</p> <p>To display a custom &quot;success&quot; message, you may return the result of the <code>Action::message</code> method from your <code>handle</code> method:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Perform the action on the given models.
 *
 * @param  \Laravel\Nova\Fields\ActionFields  $fields
 * @param  \Illuminate\Support\Collection  $models
 * @return mixed
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span>ActionFields <span class="token variable">$fields</span><span class="token punctuation">,</span> Collection <span class="token variable">$models</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token comment">// ...</span>

    <span class="token keyword">return</span> Action<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">message</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'It worked!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>To return a red, &quot;danger&quot; message, you may use the <code>Action::danger</code> method:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> Action<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">danger</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'Something went wrong!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="redirect-responses"><a href="#redirect-responses" class="header-anchor">#</a> Redirect Responses</h4> <p>To redirect the user to an entirely new location after the action is executed, you may use the <code>Action::redirect</code> method:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> Action<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">redirect</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'https://example.com'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>To redirect the user to an internal route use the <code>Action::push</code> method:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> Action<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'/resources/posts/new'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>
  <span class="token single-quoted-string string">'viaResource'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'users'</span><span class="token punctuation">,</span>
  <span class="token single-quoted-string string">'viaResourceId'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token single-quoted-string string">'viaRelationship'</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token single-quoted-string string">'posts'</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="download-responses"><a href="#download-responses" class="header-anchor">#</a> Download Responses</h4> <p>To initiate a file download after the action is executed, you may use the <code>Action::download</code> method. The <code>download</code> method accepts the URL of the file to be downloaded as its first argument, and the desired name of the file as its second argument:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">return</span> Action<span class="token punctuation">:</span><span class="token punctuation">:</span><span class="token function">download</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'https://example.com/invoice.pdf'</span><span class="token punctuation">,</span> <span class="token single-quoted-string string">'Invoice.pdf'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h2 id="queued-actions"><a href="#queued-actions" class="header-anchor">#</a> Queued Actions</h2> <p>Occasionally, you may have actions that take a while to finish running. For this reason, Nova makes it a cinch to <a href="https://laravel.com/docs/queues" target="_blank" rel="noopener noreferrer">queue<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> your actions. To instruct Nova to queue an action instead of running it synchronously, mark the action with the <code>ShouldQueue</code> interface:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Actions</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">App<span class="token punctuation">\</span>AccountData</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Bus<span class="token punctuation">\</span>Queueable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Actions<span class="token punctuation">\</span>Action</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Support<span class="token punctuation">\</span>Collection</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Fields<span class="token punctuation">\</span>ActionFields</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Queue<span class="token punctuation">\</span>InteractsWithQueue</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Contracts<span class="token punctuation">\</span>Queue<span class="token punctuation">\</span>ShouldQueue</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">EmailAccountProfile</span> <span class="token keyword">extends</span> <span class="token class-name">Action</span> <span class="token keyword">implements</span> <span class="token class-name">ShouldQueue</span>
<span class="token punctuation">{</span>
  <span class="token keyword">use</span> <span class="token package">InteractsWithQueue</span><span class="token punctuation">,</span> Queueable<span class="token punctuation">;</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>When using queued actions, don't forget to configure and start queue workers for your application. Otherwise, your actions won't be processed.</p> <div class="custom-block danger"><p class="custom-block-title">Queued Action Files</p> <p>At this time, Nova does not support attaching <code>File</code> fields to a queued action. If you need to attach a <code>File</code> field to an action, the action must be run synchronously.</p></div> <h4 id="customizing-the-connection-and-queue"><a href="#customizing-the-connection-and-queue" class="header-anchor">#</a> Customizing The Connection And Queue</h4> <p>You may customize the queue connection and queue name that the action is queued on by setting the <code>$connection</code> and <code>$queue</code> properties within the action's constructor:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token keyword">class</span> <span class="token class-name">EmailAccountProfile</span> <span class="token keyword">extends</span> <span class="token class-name">Action</span> <span class="token keyword">implements</span> <span class="token class-name">ShouldQueue</span>
<span class="token punctuation">{</span>
  <span class="token keyword">use</span> <span class="token package">InteractsWithQueue</span><span class="token punctuation">,</span> Queueable<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{</span>
      <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">connection</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'redis'</span><span class="token punctuation">;</span>
      <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">queue</span> <span class="token operator">=</span> <span class="token single-quoted-string string">'emails'</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="action-log"><a href="#action-log" class="header-anchor">#</a> Action Log</h2> <p>It is often useful to view a log of the actions that have been run against a resource. Additionally, when queueing actions, it's often important to know when they are actually finished. Thankfully, Nova makes it a breeze to add an action log to a resource by attaching the <code>Laravel\Nova\Actions\Actionable</code> trait to the resource's corresponding Eloquent model.</p> <p>For example, we may attach the <code>Laravel\Nova\Actions\Actionable</code> trait to the <code>User</code> Eloquent model:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">namespace</span> <span class="token package">App</span><span class="token punctuation">;</span>

<span class="token keyword">use</span> <span class="token package">Laravel<span class="token punctuation">\</span>Nova<span class="token punctuation">\</span>Actions<span class="token punctuation">\</span>Actionable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Notifications<span class="token punctuation">\</span>Notifiable</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Illuminate<span class="token punctuation">\</span>Foundation<span class="token punctuation">\</span>Auth<span class="token punctuation">\</span>User</span> <span class="token keyword">as</span> Authenticatable<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">Authenticatable</span>
<span class="token punctuation">{</span>
  <span class="token keyword">use</span> <span class="token package">Actionable</span><span class="token punctuation">,</span> Notifiable<span class="token punctuation">;</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</span></code></pre></div><p>Once the trait has been attached to the model, Nova will automatically begin displaying an action log at the bottom of the resource's detail screen:</p> <p><img src="img/action-log.png" alt="Action Log"></p> <h3 id="disabling-the-action-log"><a href="#disabling-the-action-log" class="header-anchor">#</a> Disabling The Action Log</h3> <p>If you do not want to record an action in the action log, you may disable this behavior by adding a <code>withoutActionEvents</code> property on your action class:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Disables action log events for this action.
 *
 * @var bool
 */</span>
<span class="token keyword">public</span> <span class="token variable">$withoutActionEvents</span> <span class="token operator">=</span> <span class="token boolean constant">true</span><span class="token punctuation">;</span>
</code></pre></div><p>Or, using the <code>withoutActionEvents</code> method, you may disable the action log for an action when the action is attached to a resource:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Get the actions available for the resource.
 *
 * @param  \Illuminate\Http\Request  $request
 * @return array
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">actions</span><span class="token punctuation">(</span>Request <span class="token variable">$request</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">[</span>
        <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SomeAction</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">withoutActionEvents</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="queued-action-statuses"><a href="#queued-action-statuses" class="header-anchor">#</a> Queued Action Statuses</h3> <p>While a queued action is running, you may update the action's &quot;status&quot; for any of the models that were passed to the action via its model collection. For example, you may use the action's <code>markAsFinished</code> method to indicate that the action has completed processing a particular model:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Perform the action on the given models.
 *
 * @param  \Laravel\Nova\Fields\ActionFields  $fields
 * @param  \Illuminate\Support\Collection  $models
 * @return mixed
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span>ActionFields <span class="token variable">$fields</span><span class="token punctuation">,</span> Collection <span class="token variable">$models</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$models</span> <span class="token keyword">as</span> <span class="token variable">$model</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AccountData</span><span class="token punctuation">(</span><span class="token variable">$model</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token variable">$fields</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">subject</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">markAsFinished</span><span class="token punctuation">(</span><span class="token variable">$model</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>Or, if you would like to indicate that an action has &quot;failed&quot; for a given model, you may use the <code>markAsFailed</code> method:</p> <div class="language-php extra-class"><pre class="language-php"><code><span class="token comment">/**
 * Perform the action on the given models.
 *
 * @param  \Laravel\Nova\Fields\ActionFields  $fields
 * @param  \Illuminate\Support\Collection  $models
 * @return mixed
 */</span>
<span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">handle</span><span class="token punctuation">(</span>ActionFields <span class="token variable">$fields</span><span class="token punctuation">,</span> Collection <span class="token variable">$models</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$models</span> <span class="token keyword">as</span> <span class="token variable">$model</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">AccountData</span><span class="token punctuation">(</span><span class="token variable">$model</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token variable">$fields</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">subject</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>Exception <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">markAsFailed</span><span class="token punctuation">(</span><span class="token variable">$model</span><span class="token punctuation">,</span> <span class="token variable">$e</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">11/24/2020, 11:08:49 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/coursewire/nova/" class="prev router-link-active">
        Laravel Nova
      </a></span> <span class="next"><a href="/coursewire/nova/actions/registering-actions.html">
        Registering Actions
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/coursewire/assets/js/app.02511102.js" defer></script><script src="/coursewire/assets/js/2.fbd24a80.js" defer></script><script src="/coursewire/assets/js/16.073345a7.js" defer></script>
  </body>
</html>
